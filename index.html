<html>
<head>
  <script src="https://d3js.org/d3.v5.min.js"></script>
</head>
<body>
  <script type="text/javascript">
    var dataPj=d3.json("color.json");
    var drawChart = function(data){
      var width=400;
      var height=300;
      var barwidth=width/data.length;
      var svg=d3.select("svg")
                .attr("width",width)
                .attr("height",height);
      svg.selectAll("rect")
         .data(data)
         .enter()
         .append("rect")
         .attr("x",function(d,i){
           return i*barwidth
         })
         .attr("y",function(d){
           return height- d.num*15
         })
         .attr("width",barwidth)
         .attr("height",function(d){
           return d.num*15
         })
         .attr("fill",function(d){
           return d.color
         })
    }
    dataPj.then(function(data){
      console.log(data),
      drawChart(data)
    })

    var legend = svg.selectAll('.legend')                     // NEW
          .data(color.domain())                                   // NEW
          .enter()                                                // NEW
          .append('g')                                            // NEW
          .attr('class', 'legend')                                // NEW
          .attr('transform', function(d, i) {                     // NEW
            var height = legendRectSize + legendSpacing;          // NEW
            var offset =  height * color.domain().length / 2;     // NEW
            var horz = -2 * legendRectSize;                       // NEW
            var vert = i * height - offset;                       // NEW
            return 'translate(' + horz + ',' + vert + ')';        // NEW
          });                                                     // NEW

        legend.append('rect')                                     // NEW
          .attr('width', legendRectSize)                          // NEW
          .attr('height', legendRectSize)                         // NEW
          .style('fill', color)                                   // NEW
          .style('stroke', color);                                // NEW

        legend.append('text')                                     // NEW
          .attr('x', legendRectSize + legendSpacing)              // NEW
          .attr('y', legendRectSize - legendSpacing)              // NEW
          .text(function(d) { return d; });                       // NEW

      })



    </script>
  <svg>
    </svg>

  </body>
</html>
